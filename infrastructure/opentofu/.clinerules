## Infrastructure Deployment Rules

### Terraform/OpenTofu Standards
- Maintain a single deployment directory structure
- Environment differences handled exclusively through:
  - Vault secrets at "kv-${var.repo_name}-${var.environment}/<service>"
  - Environment variables passed to Terraform
- Strictly prohibited patterns:
  - Environment-specific directories (dev/prod/accept)
  - Environment-specific branches
  - Hardcoded credentials in configuration files

### Secret Management
- All secrets must use Vault path format "kv-${var.repo_name}-${var.environment}/<service>"
- Service-specific secrets stored as multiple keys under the same path
- Example for Proxmox:
  example_proxmox_config: |
    data "vault_generic_secret" "proxmox" {
      path = "kv-${var.repo_name}-${var.environment}/proxmox"
    }

    # Access secrets as:
    # data.vault_generic_secret.proxmox.data["api_url"]
    # data.vault_generic_secret.proxmox.data["api_token"]
- Production secrets must only be injected through CI/CD pipelines
- Local development secrets should use "environment=dev"

### Version Control
- State backend configuration is pending implementation
- Temporary local state storage permitted during development
- Final state storage solution must:
  - Support environment isolation
  - Include access controls
  - Enable state locking

### Module Requirements
- All modules must include:
  - Complete README.md with usage examples
  - Environment variable declarations
  - Vault secret path documentation
